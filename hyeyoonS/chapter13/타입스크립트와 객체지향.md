# 1. íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì˜ ê°ì²´ ì§€í–¥

## â€œğŸ¤” FEì— ê°ì²´ ì§€í–¥ì„ ì–´ë–»ê²Œ ì ìš©í•˜ì§€?â€

- ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” í”„ë¡œí† íƒ€ì… ê¸°ë°˜ì˜ ê°ì²´ ì§€í–¥ ì–¸ì–´ì´ì§€ë§Œ, ì˜¨ì „íˆ êµ¬í˜„í•˜ëŠ” ë°ì—ëŠ” ë¶€ì¡±í•¨
    
    â‡’ì´ë¥¼ ë³´ì™„í•  ìˆ˜ ìˆëŠ” íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì˜ ë“±ì¥
    
    - ì ì§„ì  íƒ€ì´í•‘, êµ¬ì¡°ì  íƒ€ì´í•‘, ë• íƒ€ì´í•‘ì´ ê²°í•©ëœ ì–¸ì–´ â‡’ ê°ì²´ì§€í–¥ì˜ í­å¤§
        - `ì ì§„ì  íƒ€ì´í•‘` : ê°œë°œìê°€ ëª…ì‹œí•œ ì¼ë¶€ë¶„ë§Œ ì •ì  íƒ€ì… ê²€ì‚¬, ë‚˜ë¨¸ì§€ëŠ” ë™ì  íƒ€ì… ê²€ì‚¬
        - `ë• íƒ€ì´í•‘` : ê°ì²´ì˜ ë³€ìˆ˜ì™€ ë©”ì„œë“œ ì§‘í•©ì´ ê°ì²´ì˜ íƒ€ì…ì„ ê²°ì •í•¨
        - `êµ¬ì¡°ì  íƒ€ì´í•‘` : (â†”ë…¸ë¯¸ë„ íƒ€ì´í•‘) ëª…ì‹œì  ì„ ì–¸ì´ë‚˜ ì´ë¦„ì˜ ì˜ì¡´í•˜ì—¬ ëª…í™•í•œ ìƒì† ê´€ê³„ë¥¼ ì§€í–¥í•˜ì§€ ì•Šê³ , ê°ì²´ì˜ ì†ì„±ì— í•´ë‹¹í•˜ëŠ” íŠ¹ì • íƒ€ì…ì˜ ì†ì„±ì„ ê°–ëŠ”ì§€ë¥¼ ê²€ì‚¬í•˜ì—¬ íƒ€ì… í˜¸í™˜ì„±ì„ ê²°ì •

## â€œğŸ¤” ê°ì²´ ì§€í–¥ì˜ ê´€ì ì—ì„œ íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ê°€ FEì— ì–´ë–¤ ì´ì ì„ ì£¼ëŠ”ê±°ì§€?â€

- íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ëŠ” propì„ `interface` ë¡œ ì •ì˜í•  ìˆ˜ ìˆë‹¤.
ê°ì²´ ì§€í–¥ íŒ¨ëŸ¬ë‹¤ì„ì—ì„œëŠ” `ê°ì²´ ê°„ì˜ í˜‘ë ¥ ê´€ê³„`ì— ì´ˆì ì„ ë‘”ë‹¤. ì»´í¬ë„ŒíŠ¸ ê°„ì˜ í˜‘ë ¥ ê´€ê³„ë¥¼ í‘œí˜„í•˜ëŠ” ê²ƒì´ propì´ë‹¤. ë˜í•œ ê°ì²´ ìì²´ê°€ ì•„ë‹ˆë¼ í”„ë ˆì„ì›Œí¬ì— ì˜í•´ ê°ì²´ì˜ ì˜ì¡´ì„±ì´ ì£¼ì…ë˜ëŠ” DIíŒ¨í„´ì„ ë”°ë¥´ëŠ”ë°, íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¡œ `DIíŒ¨í„´`ì„ ë”ìš± ëª…í™•í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.
    
    > ğŸ¤” **DIë¥¼ ì–´ë–»ê²Œ êµ¬í˜„í•˜ëŠ”ê±°ì§€? <br>
    â‡’** Aí´ë˜ìŠ¤ê°€ Bí´ë˜ìŠ¤ì— ì˜ì¡´í•œë‹¤ê³  í•˜ë”ë¼ë„, Aê°€ Bì˜ êµ¬ì²´ í´ë˜ìŠ¤ê°€ ì•„ë‹ˆë¼ Bì˜ interfaceì— ì˜ì¡´í•˜ë„ë¡ ì„¤ê³„í•´ì•¼ í•œë‹¤.<br>
    > ğŸ¤” **DIë¥¼ í•˜ë©´ ë­ê°€ ì¢‹ì€ê±°ì§€?<br>
    â‡’** ê°ì²´ ê°„ì˜ ê²°í•©ë„ë¥¼ ë‚®ì¶œ ìˆ˜ ìˆë‹¤!<br>
    > 
<br>
    
- íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ìì²´ê°€ ê°ì²´ ì§€í–¥ì ìœ¼ë¡œ ë‹¤ì–‘í•œ ì¸¡ë©´ì„ í‘œí˜„í•˜ëŠ” ë° í° ì¥ì ì„ ê°€ì§€ê³  ìˆë‹¤.
ì ì§„ì  íƒ€ì´í•‘, êµ¬ì¡°ì  íƒ€ì´í•‘, ë• íƒ€ì´í•‘ì„ ê²°í•©í•œ ì–¸ì–´ë¼ì„œ!
<br>


# 2. ìš°ì•„í•œ í˜•ì œë“¤ì˜ í™œìš© ë°©ì‹

> 1. ì˜¨ì „íˆ ë ˆì´ì•„ì›ƒë§Œ ë‹´ë‹¹í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ ì˜ì—­
> 2. ì»´í¬ë„ŒíŠ¸ ì˜ì—­ ìœ„ì—ì„œ ë ˆì´ì•„ì›ƒê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì—°ê²°í•´ì£¼ëŠ” ì»¤ìŠ¤í…€ í›… ì˜ì—­
> 3. í›… ìœ„ì—ì„œ ê°ì²´ë¡œ ìƒí˜¸ í˜‘ë ¥í•˜ëŠ” ëª¨ë¸ ì˜ì—­
> 4. ëª¨ë¸ ìœ„ì—ì„œ APIë¥¼ í•´ì„í•˜ì—¬ ëª¨ë¸ë¡œ ì „ë‹¬í•˜ëŠ” APIë ˆì´ì–´ ì˜ì—­

<br>

### 1. ì˜¨ì „íˆ ë ˆì´ì•„ì›ƒë§Œ ë‹´ë‹¹í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ ì˜ì—­

- ì˜¨ì „íˆ ë ˆì´ì•„ì›ƒë§Œ ë‹´ë‹¹í•œë‹¤.
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ `useCartStore` ë‚´ë¶€ ì–´ë”˜ê°€ì— ìˆì„ ê²ƒì´ë‹¤.

```tsx
// components/CartCloseoutDialog.tsx

import { useCartStore } from "store/modules/cart";

const CartCloseoutDialog: React.VFC = () => {
  const cartStore = useCartStore();

  return (
    <Dialog
      opened={cartStore.PresentationTracker.isDialogOpen("closeout")}
      title="ë§ˆê° ì„¸ì¼ì´ë€?"
      onRequestClose={cartStore.PresentationTracker.closeDialog}
    >
      <div
        css={css`
          margin-top: 8px;
        `}
      >
        ì§€ì ë³„ í•œì • ìˆ˜ëŸ‰ìœ¼ë¡œ ì œê³µë˜ëŠ” í• ì¸ ìƒí’ˆì…ë‹ˆë‹¤. ì¬ê³  ì†Œì§„ ì‹œ ê°€ê²©ì´
        ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìœ í†µê¸°í•œì´ ë‹¤ì†Œ ì§§ìœ¼ë‚˜ ì¢‹ì€ í’ˆì§ˆì˜ ìƒí’ˆì…ë‹ˆë‹¤.
      </div>
    </Dialog>
  );
};

export default CartCloseoutDialog;
```

### 2. ì»´í¬ë„ŒíŠ¸ ì˜ì—­ ìœ„ì—ì„œ ë ˆì´ì•„ì›ƒê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì—°ê²°í•´ì£¼ëŠ” ì»¤ìŠ¤í…€ í›… ì˜ì—­

- ì „ì—­ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” ìŠ¤í† ì–´ ë‚´ì˜ useCartStore
- ì¥ë°”êµ¬ë‹ˆì— ìƒí’ˆì„ ë‹´ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë ˆì´ì•„ì›ƒê³¼ ì—°ê²°í•´ì£¼ê¸° ìœ„í•œ ì»¤ìŠ¤í…€ í›… ì˜ì—­

```tsx
// store/cart.ts

class CartStore {
  public async add(target: RecommendProduct): Promise<void> {
    const response = await addToCart(
      // addToCart í˜¸ì¶œ: APIë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ì¼ ê²ƒì´ë‹¤
      // addToCart ë‚´ë¶€ì—ì„œëŠ” addToCartRequest ì‹œë¦¬ì–¼ë¼ì´ì € í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê³  ìˆë‹¤
      addToCartRequest({
        auths: this.requestInfo.AuthHeaders,
        cartProducts: this.productsTracker.PurchasableProducts,
        shopID: this.shopID,
        target,
      })
    );
    return response.fork(
      (error, _, statusCode) => {
        switch (statusCode) {
          case ResponseStatus.FAILURE:
            this.presentationTracker.pushToast(error);
            break;
          case ResponseStatus.CLIENT_ERROR:
            this.presentationTracker.pushToast(
              "ë„¤íŠ¸ì›Œí¬ê°€ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤."
            );
            break;
          default:
            this.presentationTracker.pushToast(
              "ì—°ê²° ìƒíƒœê°€ ì¼ì‹œì ìœ¼ë¡œ ë¶ˆì•ˆì •í•©ë‹ˆë‹¤."
            );
        }
      },
      (message) => this.applyAddedProduct(target, message)
    );
  }
}

const [CartStoreProvider, useCartStore] = setupContext<CartStore>("CartStore");
export { CartStore, CartStoreProvider, useCartStore };
```

> ğŸ¤” **ì‹œë¦¬ì–¼ë¼ì´ì € í•¨ìˆ˜ê°€ ë­ì§€?** <br>
ì´ í•¨ìˆ˜ê°€ ë°ì´í„°ë¥¼ ì„œë²„ë¡œ ì „ì†¡í•˜ê¸° ì „ì— ì ì ˆí•œ í˜•íƒœë¡œ ë³€í™˜(ì§ë ¬í™”)í•˜ëŠ” ì—­í• ì„ í•œë‹¤ëŠ” ëœ»!<br>
> 
<br>

**ì‹œë¦¬ì–¼ë¼ì´ì € í•¨ìˆ˜ì¸ addToCartRequest ë‚´ë¶€**

- `AddToCartRequest íƒ€ì…`ì˜ ê°ì²´ë¥¼ ë°˜í™˜
- íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ” targetì€ `RecommedProduct íƒ€ì…`ì„ ê°€ì§„ë‹¤ â‡’ `RecommedProduct íƒ€ì…` ì€ ì–´ë””ì— ìˆì§€? â‡’ ëª¨ë¸ ì˜ì—­ì— ìˆë‹¤

```tsx
// serializers/cart/addToCartRequest.ts

import { AddToCartRequest } from "models/externals/Cart/Request";
import { IRequestHeader } from "models/externals/lib";
import {
  RecommendProduct,
  RecommendProductItem,
} from "models/internals/Cart/RecommendProduct";
import { Product } from "models/internals/Stuff/Product";

interface Params {
  auths: IRequestHeader;
  cartProducts: Product[];
  shopID: number;
  target: RecommendProduct;
}

function addToCartRequest({
  auths,
  cartProducts,
  shopID,
  target,
}: Params): AddToCartRequest {
  // cartProducts ë°°ì—´ì— target ìƒí’ˆê³¼ ë™ì¼í•œ IDê°€ ìˆëŠ”ì§€ í™•ì¸.
  const productAlreadyInCart = cartProducts.find(
    (product) => product.getId() === target.getId()
  );

  // AddToCartRequest íƒ€ì…ì˜ ê°ì²´ ë°˜í™˜.
  return {
    body: {
      items: target.getItems().map((item) => ({
        itemId: item.id,
        quantity: getItemQuantityFor(productAlreadyInCart, item),
        salePrice: item.price,
      })),
      productId: target.getId(),
      shopId: shopID,
    },
    headers: auths,
  };
}

export { addToCartRequest };
```
<br>

### 3. í›… ìœ„ì—ì„œ ê°ì²´ë¡œ ìƒí˜¸ í˜‘ë ¥í•˜ëŠ” ëª¨ë¸ ì˜ì—­

- `RecommendProduct` ëŠ” í´ë˜ìŠ¤ë¡œ í‘œí˜„ëœ ê°ì²´ë¡œ ì¶”ì²œ ìƒí’ˆì„ ë‚˜íƒ€ë‚´ê³ , ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ ë° ëª¨ë¸ ê°ì²´ì™€ í˜‘ë ¥í•œë‹¤.

```tsx
// models/Cart.ts

export interface AddToCartRequest {
  body: {
    shopId: number;
    items: { itemId: number; quantity: number; salePrice: number }[];
    productId: number;
  };
  headers: IRequestHeader;
}

/**
 * ì¶”ì²œ ìƒí’ˆ ê´€ë ¨ class
 */

// ì¶”ì²œ ìƒí’ˆì„ ë‚˜íƒ€ë‚´ëŠ” í´ë˜ìŠ¤ ê°ì²´
export class RecommendProduct {
  // í´ë˜ìŠ¤ ì†ì„±ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ë©”ì†Œë“œë“¤.
  public getId(): number {
    return this.id;
  }

  public getName(): string {
    return this.name;
  }

  public getThumbnail(): string {
    return this.thumbnailImageUrl;
  }

  public getPrice(): RecommendProductPrice {
    return this.price;
  }

  public getCalculatedPrice(): number {
    const price = this.getPrice();
    return price.sale?.price ?? price.origin;
  }

  public getItems(): RecommendProductItem[] {
    return this.items;
  }

  public getType(): string {
    return this.type;
  }

  public getRef(): string {
    return this.ref;
  }

  // í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•  ë•Œ ì´ˆê¸°í™” ê³¼ì •ì„ ë‹´ë‹¹í•¨.
  constructor(init: any) {
    this.id = init.id;
    this.name = init.displayName;
    this.thumbnailImageUrl = init.thumbnailImageUrl;
    this.price = {
      // í• ì¸ ê°€ê²©ì´ ìˆì„ ê²½ìš°, í• ì¸ê°€ê²©ê³¼ í• ì¸ìœ¨ í¬í•¨
      // ì—†ì„ ê²½ìš°, ì›ë˜ ê°€ê²©ë§Œ ì„¤ì •í•¨.
      sale: init.displayDiscounted
        ? {
            price: Math.floor(init.salePrice),
            percent: init.discountPercent,
          }
        : null,
      origin: Math.floor(init.retailPrice),
    };
    this.type = init.saleUnit;
    this.items = init.items.map((item) => {
      return {
        id: item.id,
        minQuantity: item.minCount,
        price: Math.floor(item.salePrice),
      };
    });
    this.ref = init.productRef;
  }

  private id: number;
  private name: string;
  private thumbnailImageUrl: string;
  private price: RecommendProductPrice;
  private items: RecommendProductItem[];
  private type: string;
  private ref: string;
}
```
<br>

### 4. ëª¨ë¸ ìœ„ì—ì„œ APIë¥¼ í•´ì„í•˜ì—¬ ëª¨ë¸ë¡œ ì „ë‹¬í•˜ëŠ” APIë ˆì´ì–´ ì˜ì—­

```tsx
// apis/Cart.ts

// APIResponseëŠ” ë°ì´í„° ë¡œë“œì— ì„±ê³µí•œ ìƒíƒœì™€ ì‹¤íŒ¨í•œ ìƒíƒœì˜ ë°˜í™˜ ê°’ì„ ì œë„¤ë¦­í•˜ê²Œ í‘œí˜„í•´ì£¼ëŠ” API ì‘ë‹µ ê°ì²´ì´ë‹¤
// (APIResponse<OK, Error>)
interface APIResponse<OK, Error> {
  // API ì‘ë‹µì— ì„±ê³µí•œ ê²½ìš°ì˜ ë°ì´í„° í˜•ì‹
  ok: OK;
  // API ì‘ë‹µì— ì‹¤íŒ¨í•œ ê²½ìš°ì˜ ì—ëŸ¬ í˜•ì‹
  error: Error;
}

export const addToCart = async (
  param: AddToCartRequest
): Promise<APIResponse<string, string>> => {
  return (await GatewayAPI.post<IAddCartResponse>("/v3/cart", param)).map(
    (data) => data.message
  );
};
```

<br>


# 3. ìº¡ìŠí™”ì™€ ì¶”ìƒí™”

ì ì ˆí•˜ê²Œ ìº¡ìŠí™”ë˜ê³  ì¶”ìƒí™”ëœ ì»´í¬ë„ŒíŠ¸ë¥¼ í™œìš©í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë” ìœ ê¸°ì ìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. 
ìµœì¢…ì ì¸ ìš°ë¦¬ì˜ ì§€í–¥ì ì€ ê°ì²´ë“¤ì´ ìœ ê¸°ì ìœ¼ë¡œ í˜‘ë ¥í•˜ê²Œë” í•´ì„œ ì˜¬ë°”ë¥´ê²Œ ë„ë©”ì¸ì„ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ë‹¤.

> ğŸ¤”**ìº¡ìŠí™”ê°€ ë­ì§€?**
> - ë‹¤ë¥¸ ê°ì²´ ë‚´ë¶€ì˜ ë°ì´í„°ë¥¼ êº¼ë‚´ì™€ì„œ ì§ì ‘ ë‹¤ë£¨ì§€ ì•Šê³ , í•´ë‹¹ ê°ì²´ì—ì„œ ì²˜ë¦¬í•  í–‰ìœ„ë¥¼ ë”°ë¡œ ìš”ì²­í•¨ìœ¼ë¡œì¨ í˜‘ë ¥í•˜ëŠ” ê²ƒ
> - ì»´í¬ë„ŒíŠ¸ëŠ” ê°ì²´ì´ë‹¤ â‡’ ì»´í¬ë„ŒíŠ¸ì˜ ë‚´ë¶€ ë°ì´í„°ì¸ ìƒíƒœ(state)ëŠ” ìº¡ìŠí™”ì˜ ëŒ€ìƒì´ ë  ìˆ˜ ìˆë‹¤.
>    â‡’ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ì˜ ìƒíƒœì™€ propì„ ì˜ ë‹¤ë£¨ëŠ” ê²ƒë„ ìº¡ìŠí™”ì˜ ê°œë…ì— ë¶€í•©í•œë‹¤!
> - Prop drillingì´ ì‹¬í•  ìˆ˜ë¡ ì»´í¬ë„ŒíŠ¸ ê°„ì˜ ê²°í•©ë„ëŠ” ë†’ì•„ì§€ê³  ë‚´ë¶€ ì²˜ë¦¬ ë¡œì§ì´ ì™¸ë¶€ë¡œ ë“œëŸ¬ë‚œë‹¤. â‡’ Prop drillingì€ ìº¡ìŠí™”ë¥¼ ì €í•´í•œë‹¤
> 

> **ğŸ¤”ì¶”ìƒí™”ê°€ ë­ì§€?**
> - ê°ì²´ë“¤ì„ ëª¨ë¸ë§í•˜ëŠ” ê³¼ì • ìì²´
> - ê°ì²´ë“¤ì„ ì‚¬ëŒë“¤ì´ ì¸ì§€í•˜ê¸°ì— ì í•©í•˜ë„ë¡ ì„¤ê³„ë¥¼ í•˜ëŠ” ê²ƒ

<br>
