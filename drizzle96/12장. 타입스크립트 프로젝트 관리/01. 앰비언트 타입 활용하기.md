# 12μ¥. νƒ€μ…μ¤ν¬λ¦½νΈ ν”„λ΅μ νΈ κ΄€λ¦¬

## 12-1. μ•°λΉ„μ–ΈνΈ νƒ€μ… ν™μ©ν•κΈ°

### 1. μ•°λΉ„μ–ΈνΈ νƒ€μ… μ„ μ–Έ

μ•°λΉ„μ–ΈνΈ νƒ€μ…μ€ νƒ€μ…μ¤ν¬λ¦½νΈ μ»΄νμΌλ¬κ°€ νƒ€μ…μ„ ν™•μΈν•κΈ° μ–΄λ ¤μΈ λ• (ex. μλ°”μ¤ν¬λ¦½νΈλ΅ μ‘μ„±λ λΌμ΄λΈλ¬λ¦¬ μ‚¬μ©, png λ“± μ΄λ―Έμ§€ νμΌμ„ λ¨λ“λ΅ μ„ν¬νΈν•  λ•) μ‚¬μ©ν•λ‹¤. μ•°λΉ„μ–ΈνΈ νƒ€μ…μ„ ν†µν•΄ μ»΄νμΌλ¬μ—κ² νƒ€μ… μ •λ³΄λ¥Ό μ•λ ¤μ£Όκ±°λ‚ κΈ°μ΅΄ (μ „μ—­) λ³€μ νƒ€μ…μ„ ν™•μ¥ν•κΈ° μ„ν•΄ μ‚¬μ©ν•  μ μλ‹¤.

μ•°λΉ„μ–ΈνΈ νƒ€μ…μ€ μ£Όλ΅ .d.tsμ— μ„ μ–Έν•λ”λ°, .d.ts νμΌμ—μ„λ” νƒ€μ… μ„ μ–Έλ§ ν•  μ μμΌλ©° κ°’μ„ ν‘ν„ν•  μ μ—†λ‹¤. μ•°λΉ„μ–ΈνΈ νƒ€μ… μ„ μ–ΈμΌλ΅ κ°’μ„ μ •μν•  μλ” μ—†μ§€λ§ declare ν‚¤μ›λ“λ¥Ό μ‚¬μ©ν•μ—¬ μ–΄λ”κ°€μ— μλ°”μ¤ν¬λ¦½νΈ κ°’μ΄ μ΅΄μ¬ν•λ‹¤λ” μ‚¬μ‹¤μ„ μ•λ¦΄ μ μλ‹¤.

### 2. μ•°λΉ„μ–ΈνΈ νƒ€μ… μ„ μ–Έ μ‹ μ£Όμμ 

#### π“ νƒ€μ…μ¤ν¬λ¦½νΈλ΅ λ§λ“λ” λΌμ΄λΈλ¬λ¦¬μ—λ” λ¶ν•„μ”

tsconfig.jsonμ declarationμ„ trueλ΅ μ„¤μ •ν•λ©΄ νƒ€μ…μ¤ν¬λ¦½νΈ μ»΄νμΌλ¬κ°€ .d.ts νμΌμ„ μλ™μΌλ΅ μƒμ„±ν•΄μ£ΌκΈ° λ•λ¬Έμ— μλ™μΌλ΅ .d.ts νμΌμ„ μ‘μ„±ν•  ν•„μ”κ°€ μ—†λ‹¤.

#### π“ μ „μ—­μΌλ΅ νƒ€μ…μ„ μ •μν•μ—¬ μ‚¬μ©ν•  λ• μ£Όμν•΄μ•Ό ν•  μ 

μ•°λΉ„μ–ΈνΈ νƒ€μ…μ€ λ…μ‹μ μΈ export/import μ—†μ΄ μ „μ—­μ—μ„ μ‚¬μ©λλ‹¤. λ§μ•½ μ„λ΅ λ‹¤λ¥Έ νμΌ(or λΌμ΄λΈλ¬λ¦¬)μ—μ„ λ™μΌν• μ΄λ¦„μ μ•°λΉ„μ–ΈνΈ νƒ€μ… μ„ μ–Έμ„ ν•λ‹¤λ©΄ μ¶©λμ΄ λ°μƒν•  μ μλ‹¤. κ·Έλ¦¬κ³  μ½”λ“μ μμ΅΄μ„± κ΄€κ³„κ°€ λ…ν™•ν•μ§€ μ•μ•„ λ³€κ²½ μ‹ μ–΄λ ¤μ›€μ„ κ²μ„ μ μλ‹¤.

### 3. μ•°λΉ„μ–ΈνΈ νƒ€μ… μ„ μ–Έμ„ μλ» μ‚¬μ©ν–μ„ λ•μ λ¬Έμ μ 

μ•°λΉ„μ–ΈνΈ νƒ€μ…μ€ λ…μ§€μ μΈ export/import μ—†μ΄ μ „μ—­μ—μ„ μ‚¬μ©λκΈ° λ•λ¬Έμ— .ts νμΌ λ‚΄μ μ•°λΉ„μ–ΈνΈ νƒ€μ… μ„ μ–Έμ€ νΌλ€μ„ μ•ΌκΈ°ν•  μ μλ‹¤. μ΄ λ¬Έμ λ” μ†μ¤μ½”λ“ κ·λ¨κ°€ ν΄μλ΅ λ” λ³€κ²½μ„ μ–΄λ µκ² ν•λ‹¤.

λ”°λΌμ„ μ•°λΉ„μ–ΈνΈ νƒ€μ… μ„ μ–Έμ€ .d.ts νμΌ λ‚΄μ—μ„ ν•λ” κ²ƒμ΄ κ°λ°μ κ°„μ μ•½μ†μ΄λ‹¤. νƒ€μ… μ„ μ–Έ μ„μΉκ°€ λ…ν™•ν•΄μ•Ό κ°€λ…μ„±μ΄ λ†’μ•„μ§€κ³  μ μ§€λ³΄μκ°€ μ©μ΄ν•λ‹¤.

### 4. μ•°λΉ„μ–ΈνΈ νƒ€μ… ν™μ©ν•κΈ°

#### π“ μλ°”μ¤ν¬λ¦½νΈλ΅ μ‘μ„±λ λΌμ΄λΈλ¬λ¦¬

μλ°”μ¤ν¬λ¦½νΈλ΅ μ‘μ„±λ λΌμ΄λΈλ¬λ¦¬λ” νƒ€μ… μ„ μ–Έμ΄ μ΅΄μ¬ν•μ§€ μ•μ•„ νƒ€μ…μ¤ν¬λ¦½νΈ ν”„λ΅μ νΈμ—μ„ μ‚¬μ©ν•λ©΄ λ¨λ“μ€ μ „λ¶€ anyλ΅ μ¶”λ΅ λλ‹¤. λ§μ•½ tsconfig.jsonμ—μ„ any μ‚¬μ©μ„ λ§‰λ” μµμ…μ΄ μΌμ Έ μλ‹¤λ©΄ μ»΄νμΌ μ—λ¬κ°€ λ°μƒν•  κ²ƒμ΄λ‹¤.

μ΄ λ• .d.ts νμΌμ—μ„ λΌμ΄λΈλ¬λ¦¬μ μ•°λΉ„μ–ΈνΈ νƒ€μ…μ„ μ„ μ–Έν•λ©΄ μ»΄νμΌλ¬κ°€ .d.ts νμΌμ„ ν†µν•΄ νƒ€μ… κ²€μ‚¬λ¥Ό μ§„ν–‰ν•λ©΄μ„ μ»΄νμΌ μ—λ¬κ°€ μ‚¬λΌμ§„λ‹¤. λν• μ½”λ“ μ‘μ„± μ‹ νƒ€μ… ννΈλ¥Ό μ κ³µλ°›μ„ μλ„ μλ‹¤.

λ³„λ„λ΅ νƒ€μ… μ •λ³΄λ¥Ό μ κ³µν•λ” μλ°”μ¤ν¬λ¦½νΈ λΌμ΄λΈλ¬λ¦¬λ” λ³΄ν†µ @types/ν¨ν‚¤μ§€λ… μ„ ν†µν•΄ μ¶”κ°€ν•  μ μλ‹¤. μ΄ λ• tscλ” λ³„λ„μ μ„¤μ • μ—†μ΄λ„ node_modules/@types λ””λ ‰ν† λ¦¬μ— μλ” νƒ€μ… μ„ μ–Έμ„ νƒ€μ… κ²€μ‚¬μ— ν™μ©ν•λ‹¤.

#### π“ νƒ€μ…μ¤ν¬λ¦½νΈλ΅ μ‘μ„±λ λΌμ΄λΈλ¬λ¦¬

νƒ€μ…μ¤ν¬λ¦½νΈλ΅ μ‘μ„±λ λΌμ΄λΈλ¬λ¦¬λΌλ„ λ°°ν¬ν•  λ• JS νμΌκ³Ό .d.ts νμΌλ΅ λ°°ν¬ν•λ” κ²ƒμ΄ μΌλ°μ μ΄λ‹¤. κ·Έ μ΄μ λ” λΌμ΄λΈλ¬λ¦¬ μ½”λ“λ¥Ό λ”°λ΅ μ»΄νμΌ(νΈλμ¤νμΌ) ν•μ§€ μ•μ•„λ„ λκΈ° λ•λ¬Έμ— μ»΄νμΌ μ‹κ°„μ΄ λ‹¨μ¶•λλ©°, .d.ts νμΌμ— μ •μλ νƒ€μ… μ •λ³΄λ¥Ό λΌμ΄λΈλ¬λ¦¬ λ¨λ“ μ‚¬μ© μ‹ ν™μ©ν•  μ μκΈ° λ•λ¬Έμ΄λ‹¤.

#### π“ νƒ€μ…μ„ μ •μν•μ—¬ μ…ν¬νΈ μ—†μ΄ μ „μ—­μΌλ΅ κ³µμ 

.d.ts νμΌμ—μ„ νƒ€μ…μ„ μ„ μ–Έν•λ©΄ μ „μ—­ λ³€μμ™€ κ°™μ€ μ—­ν• μ„ ν•κΈ° λ•λ¬Έμ— λ¨λ“  μ½”λ“ λ‚΄μ— export/import μ—†μ΄ μ‚¬μ©μ΄ κ°€λ¥ν•λ‹¤. μ΄λ° νΉμ„±μ„ μ΄μ©ν•΄ μμ£Ό μ‚¬μ©λλ” μ ν‹Έλ¦¬ν‹° νƒ€μ…μ„ μ•°λΉ„μ–ΈνΈ νƒ€μ…μΌλ΅ μ„ μ–Έν•΄μ„, λ¨λ“  μ½”λ“μ—μ„ νƒ€μ…μ„ import μ—†μ΄ μ‚¬μ©ν•  μ μλ‹¤.

```ts
// src/index.d.ts
type Optional<T extends object, K extends keyof T = keyof T> = Omit<T, K> & Partial<Pick<T, K>>;

// src/components.ts
type Props = {name: string; age: number; visible: boolean;};

// Expect: {name ?: string; age?: number; visible?: boolean}
type OptionalProps = Optional<Props> 

// Expect: {name: string; age?: number; visible: boolean}
type OptionalAgeProps = Optional<Props, 'age'> 
```

μ μ‚¬ν•κ² declare typeμΌλ΅ μ„ μ–Έν• νƒ€μ… μ—­μ‹ μ „μ—­μ—μ„ μ‚¬μ©ν•  μ μλ‹¤.
π .d.ts νμΌμ—μ„λ” νƒ€μ…μ„ μ„ μ–Έν•λ©΄ κΈ°λ³Έμ μΌλ΅ μ•°λΉ„μ–ΈνΈ νƒ€μ…μ΄ λκ³ , .d.tsκ°€ μ•„λ‹ νμΌμ—μ„λ” declare ν‚¤μ›λ“λ¥Ό κ°™μ΄ μ‚¬μ©ν•΄ μ•°λΉ„μ–ΈνΈ νƒ€μ…μ„ λ§λ“¤ μ μλ‹¤.

```ts
declare type Nullable<T> = T | null;

const name:Nullable<string> = 'woowa';
```

#### π“ declare moduleμ„ ν™μ©ν•΄ νμΌ ν•μ‹μ„ λ¨λ“λ΅ μ„ μ–Έν•κΈ°

νƒ€μ…μ¤ν¬λ¦½νΈμ—μ„ .jsλ‚ .tsκ°€ μ•„λ‹ .png λ“±μ νμΌμ„ import ν•λ©΄ μ»΄νμΌλ¬κ°€ νμΌ ν•μ‹μ„ μΈμ‹ν•μ§€ λ»ν•΄ μ—λ¬κ°€ λ°μƒν•λ‹¤. μ΄λ° μƒν™©μ—μ„ declare ν‚¤μ›λ“λ¥Ό μ‚¬μ©ν•΄ νΉμ • νμΌ ν•μ‹μ„ λ¨λ“λ΅ μ„ μ–Έν•λ©΄ μ—λ¬λ¥Ό ν•΄κ²°ν•  μ μλ‹¤.

```ts
declare module '*.gif' {
  const src: string;
  export default src;
}

declare module '*.png' {
  const src: string;
  export default src;
}
```

#### π“ declare moduleμ„ ν™μ©ν•΄ κΈ°μ΅΄ λ¨λ“μ„ νƒ€μ… μ¶”κ°€ν•΄μ„ μ‚¬μ©ν•κΈ°

CSS-in-JS λΌμ΄λΈλ¬λ¦¬λ” ν°νΈ ν¬κΈ°, μƒ‰μƒ λ“±μ„ κ°μ²΄λ΅ κ΄€λ¦¬ν•λ‹¤. κ·Έλ¦¬κ³  κ°μ²΄μ—μ„ Theme νƒ€μ…μ„ λ§λ“¤μ–΄ μ •μν•λ‹¤. declare moduleμ„ ν™μ©ν•λ©΄ 'styled-components' λ¨λ“μ„ import ν•  λ• Theme νƒ€μ…μ΄ ν™•μ¥λμ–΄ μλ™μΌλ΅ μ‚¬μ©ν•  μ μκ² λλ‹¤.

```ts
const fontSize = {
  xl: '30px',
  //...
};

const colors = {
  gray_100: '#222222',
  gray_200: '#444444',
  //...
};

const depths = {
  origin: 0,
  foreground: 10,
  dialog: 100,
  //...
};

const theme = {
  fontSize,
  colors,
  depths
};

declare module 'styled-components' {
  type Theme = typeof theme;
  // π κΈ°μ΅΄ 'styled-components' λ¨λ“μ— μ΅΄μ¬ν•λ” DefaultThemeκ°€ Themeμ„ μΈμ§€ν•λ„λ΅ ν™•μ¥ν•λ” μ •μ
  export interface DefaultTheme extends Theme {};
}
```

#### π“ declare namespace ν™μ©ν•κΈ°

declare namespaceλ¥Ό ν™μ©ν•΄ μ „μ—­μ¤μ½”ν”„μ— λ„¤μ„μ¤νμ΄μ¤λ¥Ό μ„ μ–Έν•  μ μλ‹¤. λ„¤μ„μ¤νμ΄μ¤λ” λ³€μ μ¤μ½”ν”„λ¥Ό λ¨λ“ν™”ν•μ—¬ λ³€μ μ¤μ½”ν”„ κ°„μ μ¶©λμ„ λ°©μ§€ν•λ‹¤.

Node.js ν™κ²½μ—μ„ .env νμΌμ„ μ‚¬μ©ν•  λ• declare namespaceλ¥Ό ν™μ©ν•μ—¬ process.env κ°’μ„ μ†μ‰½κ² λ¶λ¬μ¤κ³  μλ™ μ™„μ„± κΈ°λ¥μ„ μ‚¬μ©ν•  μ μλ‹¤. λν• process.env λ³€μ κ°’μ νƒ€μ…μ„ μ§€μ •ν•  μ μμ–΄ as λ‹¨μ–Έμ„ μ‚¬μ©ν•μ§€ μ•μ•„λ„ λκ² ν•λ‹¤.

```ts
// .env νμΌ
API_URL = 'localhost:8080';

π¨ Before
console.log(process.env.API_URL as string)

β… After
declare namespace NodeJS {
  interface ProcessEnv{
    readonly API_URL: string;
  }
}

console.log(process.env.API_URL);
```

#### π“ declare global ν™μ©ν•κΈ°

declare globalμ„ ν™μ©ν•΄ Windowμ™€ κ°™μ€ μ „μ—­ κ°μ²΄μ— μ‚¬μ©λλ” λ¨λ“μ΄λ‚ λ³€μλ¥Ό μ¶”κ°€ν•  μ μλ‹¤.

```ts
decalre global {
  interface Window {
    newProperty: string;
  }
}
```

λ€ν‘μ μΌλ΅ λ„¤μ΄ν‹°λΈ μ•±κ³Όμ ν†µμ‹ μ„ μ„ν• μΈν„°νμ΄μ¤λ¥Ό Window κ°μ²΄μ— μ¶”κ°€ν•  μ μλ‹¤.
```ts
decalre global {
  interface Window {
    webkit?: {
      messageHandlers?: Record<string, {postMessage?: (parameter: string) => void;}>
    }
  }
}
```

### 5. declareμ™€ λ²λ“¤λ¬μ μ‹λ„μ§€

λ‹¤μκ³Ό κ°™μ΄ μ „μ—­μ— _color λ³€μκ°€ μ΅΄μ¬ν•¨μ„ μ•λ¦ΌμΌλ΅μ¨ ν•΄λ‹Ή κ°μ²΄λ¥Ό import μ—†μ΄ ν™μ©ν•  μ μλ‹¤.

```ts
const color = {
  white: "#ffffff",
  black: "#000000",
} as const;

type ColorSet = typeof color;

declare global {
  const _color: ColorSet;
}
```

```ts
const white = _color["white"];
```

κ·Έλ°λ° μ΄ λ• _color λ³€μκ°€ μ‹¤μ λ΅ μ΅΄μ¬ν•μ§€ μ•μ•„λ„ νƒ€μ…μ¤ν¬λ¦½νΈ μ—λ¬κ°€ λ°μƒν•μ§€ μ•κ³  μ΄λ” λ°νƒ€μ„μ— μκΈ°μΉ μ•μ€ μ—λ¬λ¥Ό λ°μƒμ‹ν‚¬ μ μλ‹¤.

μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ λ²λ“¤ μ‹μ μ— λ²λ“¤λ¬λ¥Ό ν†µν•΄μ„ ν•΄λ‹Ή λ°μ΄ν„°λ¥Ό μ£Όμ…ν•λ” λ°©λ²•μ΄ μλ‹¤. λ‹¤μ μμ‹λ” rollup λ²λ“¤λ¬μ injectλ¥Ό ν™μ©ν•μ—¬ λ²λ“¤ μ‹μ μ— λ°μ΄ν„°λ¥Ό μ£Όμ…ν•λ” μμ‹μ΄λ‹¤.

```ts
// 1. data.ts: μƒ‰μƒ λ³€μ μ •μ
export const color = {
  white: "#ffffff",
  black: "#000000",
} as const;

// 2. type.ts : μ „μ—­ μ•°λΉ„μ–ΈνΈ νƒ€μ…μ— _color μƒ‰μƒ λ³€μ μ •μ
improt { color } from "./data";

type ColorSet = typeof color;
declare global { 
  const _color: ColorSet;
}

// 3. rollup.config.js: λ²λ“¤λ¬ μ„¤μ •μ—μ„ injectμ— κ²½λ΅μ™€ λ°μ΄ν„°λ¥Ό μ§€μ •ν•λ©΄μ„ μƒ‰μƒ λ³€μ λ°μ΄ν„°λ¥Ό μ‚½μ…
import inject from "@rollup/plugin-inject";
import typescript from "@rollup/plugin-typescript";

export default [
  {
    input: "index.ts",
    output: [
      {
        dir: "lib",
        format: "esm",
      },
    ],
    plugins: [typescript(), inject({ _color: ["./data", "color"] })],
  },
];

// 4. index.ts: μ‚¬μ©μ²
console.log(_color["white"]);
```
