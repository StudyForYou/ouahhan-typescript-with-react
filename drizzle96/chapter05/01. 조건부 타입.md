# 5ì¥. íƒ€ì… í™œìš©í•˜ê¸°

## 5-1. ì¡°ê±´ë¶€ íƒ€ì…

- ì¡°ê±´ë¶€ íƒ€ì…ì˜ í˜•íƒœ: Condition ? A : B;
- ì¡°ê±´ë¶€ íƒ€ì… í™œìš©ì˜ ì¥ì 
  - ì¤‘ë³µë˜ëŠ” íƒ€ì… ì½”ë“œ ì œê±°
  - ë” ì •í™•í•œ íƒ€ì… ì¶”ë¡ 

### 1. extendsì™€ ì œë„¤ë¦­ì„ í™œìš©í•œ ì¡°ê±´ë¶€ íƒ€ì…

```ts
// íƒ€ì… Tì— Uë¥¼ í• ë‹¹í•  ìˆ˜ ìˆìœ¼ë©´ X íƒ€ì…, ì•„ë‹ˆë©´ Y íƒ€ì…ìœ¼ë¡œ ê²°ì •ëœë‹¤.
T extends U ? X : Y
```
ğŸ“ ì˜ˆì‹œ ì½”ë“œ
```ts
interface Bank {
  financialCode: string;
  fullName: string;
}

interface Card {
  financialCode: string;
  appCardType?: string;
}

type payMethod<T> = T extends "card" ? Card : Bank;
// 1. ì œë„¤ë¦­ ë§¤ê°œë³€ìˆ˜ì— "card"ê°€ ì˜¤ë©´, T extends "card"ê°€ ì°¸ì´ ë˜ì–´ Card íƒ€ì…ì´ ëœë‹¤.
// 1. ì œë„¤ë¦­ ë§¤ê°œë³€ìˆ˜ì— "bank"ê°€ ì˜¤ë©´, T extends "card"ê°€ ê±°ì§“ì´ ë˜ì–´ Bank íƒ€ì…ì´ ëœë‹¤.
type CardPayMethodType = PayMethod<"card">;
type BankPayMethodType = PayMethod<"bank">;
```

### 2. ì¡°ê±´ë¶€ íƒ€ì…ì„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ì„ ë•Œì˜ ë¬¸ì œì 

React Queryë¥¼ ì‚¬ìš©í•œ ë°°ë¯¼ í”„ë¡œì íŠ¸ ì½”ë“œë¥¼ ë³´ë©° ë¬¸ì œë¥¼ íŒŒì•…í•˜ì. 
ê³„ì¢Œ(bank), ì¹´ë“œ(card), ì•±ì¹´ë“œ(appcard)ì˜ 3ê°€ì§€ ê²°ì œ ìˆ˜ë‹¨ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” APIê°€ ìˆë‹¤.
APIëŠ” ê³µí†µì ìœ¼ë¡œ ê²°ì œ ìˆ˜ë‹¨ ì •ë³´ë¥¼ ë°°ì—´ë¡œ ë°˜í™˜í•˜ë©°, ì—”ë“œí¬ì¸íŠ¸ê°€ ë¹„ìŠ·í•˜ê¸° ë•Œë¬¸ì— ê³µí†µ í•¨ìˆ˜ë¥¼ ìƒì„±í•˜ì—¬, í•¨ìˆ˜ì— íƒ€ì…ì„ ì „ë‹¬í•˜ì—¬ íƒ€ì…ë³„ë¡œ ì²˜ë¦¬ ë¡œì§ì„ êµ¬í˜„í–ˆë‹¤.
```ts
/**
 * 2. ì•„ë˜ í•¨ìˆ˜ì˜ ë°˜í™˜ê°’ì˜ íƒ€ì…ìœ¼ë¡œ í™œìš©í•˜ëŠ” PayMethodTypeëŠ”,
 * PayMethodInfo<Card>ê³¼ PayMethodInfo<Bank>ì˜ ìœ ë‹ˆì˜¨ íƒ€ì…ì´ë‹¤.
 * ë”°ë¼ì„œ ë°˜í™˜ê°’ì˜ íƒ€ì…ì´ ìœ ë‹ˆì˜¨ ì¤‘ í•˜ë‚˜ë¡œ ì •í•´ì§„ë‹¤ë©´ ì›í•˜ëŠ” ì˜ë„ëŒ€ë¡œ ëœë‹¤.
 */
type PayMethodType = PayMethodInfo<Card> | PayMethodInfo<Bank>;

/**
 * 1. ì½”ë“œì˜ ì˜ë„ëŠ” hookì´ ì¸ìì˜ íƒ€ì… ì¤‘ í•˜ë‚˜ë¥¼ ë°›ì•„ì„œ í•´ë‹¹ íƒ€ì…ê³¼ ì•Œë§ì€ íƒ€ì…ì„ ë°˜í™˜í•˜ê²Œ í•˜ëŠ” ê²ƒì´ë‹¤.
 * "card", "appcard" => Card
 * "bank" => Bank
 */ 
export const useGetRegisteredList = (
  type: "card" | "appcard" | "bank"
): UseQueryResult<PayMethodType[]> => {

  const url = `baeminpay/codes/${type === "appcard" ? "card" : type}`;

  const fetcher = fetcherFactory<PayMethodType[]>({
    onSuccess: (res) => {
      const usablePocketList =
        res?.filter(
          (pocket: PocketInfo<Card> | PocketInfo<Bank>) =>
            pocket?.useType === "USE"
        ) ?? [];
      return usablePocketList;
    },
  });

/**
 * 3. í•˜ì§€ë§Œ í˜„ì¬ ë°˜í™˜ê°’ì˜ íƒ€ì…ì€ PayMethodType[]ì´ë‹¤.
 * í˜„ì¬ PayMethodTypeì˜ í˜•íƒœë¡œëŠ” ìœ ë‹ˆì˜¨ìœ¼ë¡œë§Œ ì •ì˜ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, êµ¬ì²´ì ìœ¼ë¡œ ì¶”ë¡ í•  ìˆ˜ê°€ ì—†ë‹¤.
 * PayMethodTypeê°€ Cardë‚˜ Bankì˜ ì •ë³´ë¥¼ ì•Œ ìˆ˜ ìˆë„ë¡ ì¡°ê±´ë¶€ íƒ€ì…ì„ í™œìš©í•´ ë³´ì.
 */
  const result = useCommonQuery<PayMethodType[]>(url, undefined, fetcher);

  return result;
};
```

### 3. extends ì¡°ê±´ë¶€ íƒ€ì…ì„ í™œìš©í•˜ì—¬ ê°œì„ í•˜ê¸°

```ts
// ğŸš¨ Before
type PayMethodType = PayMethodInfo<Card> | PayMethodInfo<Bank>;

// âœ… After
// 1. PayMethodTypeì˜ ì œë„¤ë¦­ìœ¼ë¡œ ë°›ì€ ê°’ì´ "card" ë˜ëŠ” "appcard"ë©´ PayMethodInfo<Card> íƒ€ì…ì„ ë°˜í™˜
// 2. PayMethodTypeì˜ ì œë„¤ë¦­ìœ¼ë¡œ ë°›ì€ ê°’ì´ ì´ì™¸ì˜ ê°’ì´ë©´ PayMethodInfo<Bank> íƒ€ì…ì„ ë°˜í™˜
type PayMethodType<T extends "card" | "appcard" | "bank"> = T extends ("card" | "appcard") ? Card : Bank
```

```ts
// ğŸš¨ Before
export const useGetRegisteredList = (
  type: "card" | "appcard" | "bank"
): UseQueryResult<PayMethodType[]> => {
  /* ... */
  const result = useCommonQuery<PayMethodType[]>(url, undefined, fetcher);
  return result;
};

// âœ… After
export const useGetRegisteredList = <T extends "card" | "appcard" | "bank">(
  type: T
): UseQueryResult<PayMethodType<T>[]> => {
  /* ... */
  // í›…ì˜ ì¸ìë¡œ ë°›ëŠ” typeì„ ì œë„¤ë¦­ Të¡œ ë§Œë“¤ê³  Të¥¼ PayMethodTypeì—ë„ ì „ë‹¬í•˜ë©´ì„œ êµ¬ì²´ì ì¸ íƒ€ì… ì¶”ë¡ ì´ ê°€ëŠ¥í•´ì¡Œë‹¤!
  // ë”°ë¼ì„œ ì‚¬ìš©í•˜ëŠ” ìª½ì—ì„œ ë¶ˆí•„ìš”í•œ íƒ€ì… ê°€ë“œë‚˜ íƒ€ì… ë‹¨ì–¸ì´ í•„ìš”í•˜ì§€ ì•Šë‹¤.
  const result = useCommonQuery<PayMethodType<T>[]>(url, undefined, fetcher);
  return result;
};
```

#### ğŸ‘£ extends í™œìš© ì˜ˆì‹œ ì •ë¦¬
1. íƒ€ì…ì„ í™•ì¥í•  ë•Œ
2. ì œë„¤ë¦­ íƒ€ì…ì—ì„œ ì œë„¤ë¦­ìœ¼ë¡œ ë°›ëŠ” íƒ€ì…ì„ ì œí•œí•˜ëŠ” í•œì •ì ì—­í• 
3. ë°˜í™˜ ê°’ì„ ë” êµ¬ì²´í™” í•´ì£¼ëŠ” **ì¡°ê±´ë¶€ íƒ€ì… ì„¤ì •**

### 4. inferë¥¼ í™œìš©í•´ì„œ íƒ€ì… ì¶”ë¡ í•˜ê¸°
extendsë¥¼ ì‚¬ìš©í•  ë•Œ infer í‚¤ì›Œë“œë¥¼ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
extends ë’¤ì— ì¡°ê±´ì„ ì„œìˆ í•˜ë©´ì„œ, inferë¥¼ í†µí•´ ì¶”ë¡ ëœ ê°’ì„ ì œë„¤ë¦­ìœ¼ë¡œ í™œìš©í•˜ì—¬ êµ¬ì²´ì ì¸ íƒ€ì… í™œìš©ì´ ê°€ëŠ¥í•˜ë‹¤.

```ts
type UnpackPromise<T> = T extends Promise<infer K>[] ? K : any;
// Promise<infer K> : Promiseì˜ ë°˜í™˜ ê°’ì„ ì¶”ë¡ í•´ í•´ë‹¹ ê°’ì˜ íƒ€ì…ì„ Kë¼ê³  ì§€ì •

const promises = [Promise.resolve("Mark"), Promise.resolve(38)];
type Expected = UnpackPromise<typeof promises>; // string | number
```

ì±… ì˜ˆì‹œëŠ” ë„ˆë¬´ ë³µì¡í•´ì„œ ìƒëµ,,
